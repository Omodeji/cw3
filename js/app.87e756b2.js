(function(){"use strict";var e={5151:function(e,t,s){var o=s(5130),r=s(6768),n=s(4232);const a={id:"app"},i={class:"d-flex"},l=(0,r.Lk)("i",{class:"fa fa-cart-plus"},null,-1),c={class:"badge bg-danger"};function u(e,t,s,o,u,d){return(0,r.uX)(),(0,r.CE)("div",a,[(0,r.Lk)("div",i,[(0,r.Lk)("button",{class:"btn btn-dark fs-3 p-3 ms-auto mb-3",onClick:t[0]||(t[0]=(...e)=>d.toggleCartView&&d.toggleCartView(...e))},[l,(0,r.Lk)("span",c,(0,n.v_)(d.cartSize),1)])]),((0,r.uX)(),(0,r.Wv)((0,r.$y)(u.activeComponent),{lessons:u.lessons,cart:u.cart,baseURL:u.baseURL,onRemoveFromCart:d.removeProduct,onAddToCart:d.addToCart,onOrderSubmitted:d.resetCart},null,40,["lessons","cart","baseURL","onRemoveFromCart","onAddToCart","onOrderSubmitted"]))])}s(4114);const d={class:"container"},m=(0,r.Lk)("label",{for:"sortAttribute"},"Sort By:",-1),p=(0,r.Fv)('<option value="title">Title</option><option value="subject">Subject</option><option value="location">Location</option><option value="price">Price</option><option value="avaliability">avaliability</option>',5),h=[p],v=(0,r.Lk)("label",{for:"sortOrder"},"Sort Order:",-1),b=(0,r.Lk)("option",{value:"asc"},"Ascending",-1),L=(0,r.Lk)("option",{value:"desc"},"Descending",-1),f=[b,L],k={class:"row"},C={class:"card mb-3 rounded-0 border border-success-subtle"},y={class:"card-header d-flex"},w={class:"card-body"},O=(0,r.Lk)("i",{class:"fa fa-eur"}," per hour",-1),g={class:"card-footer"},T=["onClick","disabled"],_=(0,r.Lk)("i",{class:"fa fa-cart-plus"},null,-1),$=[_],j=["onClick"],A=(0,r.Lk)("i",{class:"fa fa-minus-circle"},null,-1),S=[A];function U(e,t,s,a,i,l){return(0,r.uX)(),(0,r.CE)("div",null,[(0,r.Lk)("div",d,[(0,r.Lk)("div",null,[(0,r.bo)((0,r.Lk)("input",{type:"text",class:"form-control","onUpdate:modelValue":t[0]||(t[0]=e=>i.searchTerm=e),placeholder:"Search Product...",onInput:t[1]||(t[1]=(...e)=>l.searchLessons&&l.searchLessons(...e))},null,544),[[o.Jo,i.searchTerm]])]),(0,r.Lk)("div",null,[m,(0,r.bo)((0,r.Lk)("select",{"onUpdate:modelValue":t[2]||(t[2]=e=>i.sortAttribute=e),class:"form-select",onChange:t[3]||(t[3]=(...e)=>l.searchLessons&&l.searchLessons(...e))},h,544),[[o.u1,i.sortAttribute]])]),(0,r.Lk)("div",null,[v,(0,r.bo)((0,r.Lk)("select",{"onUpdate:modelValue":t[4]||(t[4]=e=>i.sortOrder=e),class:"form-select mb-3",onChange:t[5]||(t[5]=(...e)=>l.searchLessons&&l.searchLessons(...e))},f,544),[[o.u1,i.sortOrder]])]),(0,r.Lk)("div",k,[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(i.localLessons,(e=>((0,r.uX)(),(0,r.CE)("div",{class:"col-sm-4",key:e._id},[(0,r.Lk)("div",C,[(0,r.Lk)("div",y,[(0,r.Lk)("div",null,[(0,r.Lk)("p",null,"Subject: "+(0,n.v_)(e.subject),1),(0,r.Lk)("h5",null,"Title: "+(0,n.v_)(e.title),1)]),(0,r.Lk)("i",{class:(0,n.C4)([e.icon,"fs-1 ms-auto"])},null,2)]),(0,r.Lk)("div",w,[(0,r.Lk)("p",null,[(0,r.eW)(" Price: "+(0,n.v_)(e.price)+" ",1),O]),(0,r.Lk)("p",null,"Location: "+(0,n.v_)(e.location),1),(0,r.Lk)("p",null,"avaliability: "+(0,n.v_)(e.avaliability),1)]),(0,r.Lk)("div",g,[(0,r.Lk)("button",{onClick:t=>l.addToCart(e),disabled:0===e.avaliability},$,8,T),(0,r.Lk)("button",{onClick:t=>l.removeProduct(e)},S,8,j)])])])))),128))])])])}var x={props:["lessons","cart","baseURL"],data(){return{searchTerm:"",sortOrder:"asc",sortAttribute:"subject",localLessons:[]}},watch:{lessons:{handler(e){this.localLessons=[...e]},immediate:!0,deep:!0}},methods:{async searchLessons(){try{const e=`?search=${this.searchTerm}&sort=${this.sortAttribute}&order=${this.sortOrder}`,t=await fetch(`${this.baseURL}search/collection/lessons/${e}`);if(!t.ok)throw new Error("Failed to fetch lessons");const s=await t.json();this.localLessons=s}catch(e){console.error(e)}},checkItemCount(e){return this.cart.reduce(((t,s)=>t+(s.lesson._id===e?s.amount:0)),0)},addToCart(e){this.canAddToCart(e)&&this.$emit("add-to-cart",e)},removeProduct(e){this.$emit("remove-from-cart",e)},canAddToCart(e){return e.avaliability>this.checkItemCount(e._id)}},computed:{cartSize(){return this.cart.reduce(((e,t)=>e+t.amount),0)},cartTotal(){return this.cart.reduce(((e,t)=>e+t.amount*t.lesson.price),0)}}},E=s(1241);const P=(0,E.A)(x,[["render",U]]);var R=P;const F={class:"container mt-4"},V={class:"row"},X={class:"col-sm-8 border rounded-3"},I={class:"col-sm-12 mb-4 p-3"},N={class:"row"},J={class:"col-sm-4"},z={class:"col-sm-4"},W=["onClick"],D=(0,r.Lk)("i",{class:"fa fa-minus-circle"},null,-1),q=[D],K={class:"col-sm-4"},B=(0,r.Lk)("i",{class:"fa fa-eur"}," per hour",-1),M={class:"col-sm-12"},Q=(0,r.Lk)("i",{class:"fa fa-eur"},null,-1),Z={class:"col-sm-4 mt-4"},G={class:"container"},H={class:"row justify-content-center"},Y={class:"col-md-12"},ee={class:"card"},te={class:"card-body"},se=(0,r.Lk)("h5",{class:"card-title"},"Details",-1),oe={class:"mb-3"},re=(0,r.Lk)("label",{for:"username",class:"form-label"},"Name",-1),ne={class:"mb-3"},ae=(0,r.Lk)("label",{for:"phone",class:"form-label"},"Number",-1),ie=["disabled"];function le(e,t,s,a,i,l){return(0,r.uX)(),(0,r.CE)("div",null,[(0,r.Lk)("div",F,[(0,r.Lk)("div",V,[(0,r.Lk)("div",X,[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(s.cart,(t=>((0,r.uX)(),(0,r.CE)("div",{key:t.lesson._id,class:"border-bottom"},[(0,r.Lk)("div",I,[(0,r.Lk)("div",N,[(0,r.Lk)("div",J,[(0,r.Lk)("i",{class:(0,n.C4)([t.lesson.icon,"display-1 ms-auto"])},null,2)]),(0,r.Lk)("div",z,[(0,r.Lk)("p",null,"Title: "+(0,n.v_)(t.lesson.title),1),(0,r.Lk)("p",null,"Quantity: "+(0,n.v_)(t.amount),1),(0,r.Lk)("p",null,[(0,r.Lk)("button",{onClick:s=>e.$emit("remove-from-cart",t.lesson)},q,8,W)])]),(0,r.Lk)("div",K,[(0,r.Lk)("p",null,[(0,r.eW)("Price: "+(0,n.v_)(t.lesson.price)+" ",1),B])])])])])))),128)),(0,r.Lk)("div",M,[(0,r.Lk)("p",null,[(0,r.eW)("Total Price: "+(0,n.v_)(l.cartTotal)+" ",1),Q])])]),(0,r.Lk)("div",Z,[(0,r.Lk)("div",G,[(0,r.Lk)("div",H,[(0,r.Lk)("div",Y,[(0,r.Lk)("div",ee,[(0,r.Lk)("div",te,[se,(0,r.Lk)("form",{onSubmit:t[2]||(t[2]=(0,o.D$)(((...e)=>l.submitOrder&&l.submitOrder(...e)),["prevent"]))},[(0,r.Lk)("div",oe,[re,(0,r.bo)((0,r.Lk)("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=e=>i.username=e),class:"form-control",id:"username",name:"username",placeholder:"Name",required:""},null,512),[[o.Jo,i.username]])]),(0,r.Lk)("div",ne,[ae,(0,r.bo)((0,r.Lk)("input",{type:"tel","onUpdate:modelValue":t[1]||(t[1]=e=>i.phone=e),class:"form-control",id:"phone",name:"phone",placeholder:"Number",required:""},null,512),[[o.Jo,i.phone]])]),(0,r.Lk)("button",{type:"submit",class:"btn btn-primary",disabled:!l.completeOrder},"Submit",8,ie)],32)])])])])])])])])])}var ce={props:["cart","baseURL"],data(){return{username:"",phone:""}},methods:{async submitOrder(){try{const t={cart:[...this.cart],username:this.username,phone:this.phone},s=await fetch(`${this.baseURL}collection/orders`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}),o=await s.text();console.log("Response Text:",o);try{const e=JSON.parse(o);if(!s.ok)throw new Error(e.message||"Failed to submit order");alert("Order submitted successfully!"),this.$emit("order-submitted")}catch(e){throw new Error(`Unexpected response format: ${o}`)}}catch(t){console.error("Error:",t.message),alert(`There was an error submitting your order: ${t.message}`)}}},computed:{completeOrder(){return/^[a-zA-Z]+$/.test(this.username)&&/^\d+$/.test(this.phone)},cartTotal(){return this.cart.reduce(((e,t)=>e+t.amount*t.lesson.price),0)}}};const ue=(0,E.A)(ce,[["render",le]]);var de=ue,me={name:"App",data(){return{lessons:[],cart:[],baseURL:"https://cw2-backend.vercel.app/",activeComponent:"LessonsComponent"}},methods:{async getLessons(){var e=await fetch(`${this.baseURL}collection/lessons`);this.lessons=await e.json()},removeProduct(e){const t=this.cart.findIndex((t=>t.lesson._id===e._id));-1!==t&&(this.cart[t].amount--,e.avaliability+=1,0==this.cart[t].amount&&this.cart.splice(t,1))},addToCart(e){if(e.avaliability>0){e.avaliability--;var t=this.cart.findIndex((t=>t.lesson._id===e._id));t>-1?this.cart[t].amount++:this.cart.push({lesson:e,amount:1})}},toggleCartView(){this.activeComponent="LessonsComponent"===this.activeComponent?"CheckOutComponent":"LessonsComponent"},resetCart(){this.cart=[]}},computed:{cartSize(){return this.cart.reduce(((e,t)=>e+t.amount),0)}},components:{LessonsComponent:R,CheckOutComponent:de},mounted(){this.getLessons()}};const pe=(0,E.A)(me,[["render",u]]);var he=pe;(0,o.Ef)(he).mount("#app")}},t={};function s(o){var r=t[o];if(void 0!==r)return r.exports;var n=t[o]={exports:{}};return e[o].call(n.exports,n,n.exports,s),n.exports}s.m=e,function(){var e=[];s.O=function(t,o,r,n){if(!o){var a=1/0;for(u=0;u<e.length;u++){o=e[u][0],r=e[u][1],n=e[u][2];for(var i=!0,l=0;l<o.length;l++)(!1&n||a>=n)&&Object.keys(s.O).every((function(e){return s.O[e](o[l])}))?o.splice(l--,1):(i=!1,n<a&&(a=n));if(i){e.splice(u--,1);var c=r();void 0!==c&&(t=c)}}return t}n=n||0;for(var u=e.length;u>0&&e[u-1][2]>n;u--)e[u]=e[u-1];e[u]=[o,r,n]}}(),function(){s.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return s.d(t,{a:t}),t}}(),function(){s.d=function(e,t){for(var o in t)s.o(t,o)&&!s.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})}}(),function(){s.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){var e={524:0};s.O.j=function(t){return 0===e[t]};var t=function(t,o){var r,n,a=o[0],i=o[1],l=o[2],c=0;if(a.some((function(t){return 0!==e[t]}))){for(r in i)s.o(i,r)&&(s.m[r]=i[r]);if(l)var u=l(s)}for(t&&t(o);c<a.length;c++)n=a[c],s.o(e,n)&&e[n]&&e[n][0](),e[n]=0;return s.O(u)},o=self["webpackChunkcoursework3"]=self["webpackChunkcoursework3"]||[];o.forEach(t.bind(null,0)),o.push=t.bind(null,o.push.bind(o))}();var o=s.O(void 0,[504],(function(){return s(5151)}));o=s.O(o)})();
//# sourceMappingURL=app.87e756b2.js.map
